{% extends "base.html" %}

{% block header %}

<h1>{{ header_text }}</h1>

{% endblock %}

{% block main_content %}
<div id="sidebar">
  <div>
    <form action="/admin" method="post">
      <h2 class="section_heading">Metadata (tc_header)</h2>
      <ul>
        <li><button name="action" value="{{ AdminAction::InsertOne }}">{{ AdminAction::InsertOne.long_display() }}</button></li>
        <li><button name="action" value="{{ AdminAction::InsertMany }}">{{ AdminAction::InsertMany.long_display() }}</button></li>
        <li><button name="action" value="{{ AdminAction::InsertWithTemplate }}">{{ AdminAction::InsertWithTemplate.long_display() }}</button></li>
        <li><button name="action" value="{{ AdminAction::EditOne }}">{{ AdminAction::EditOne.long_display() }}</button></li>
        <li><button name="action" value="{{ AdminAction::CreatePackets }}">{{ AdminAction::CreatePackets.long_display() }}</button></li>
      </ul>

      <h2 class="section_heading">Count data</h2>
      <ul>
        <li><button name="action" value="{{ AdminAction::ImportEcoCounter }}">{{ AdminAction::ImportEcoCounter.long_display() }}</button></li>
        <li><button name="action" value="{{ AdminAction::ImportJamar }}">{{ AdminAction::ImportJamar.long_display() }}</button></li>
        <li><button name="action" value="{{ AdminAction::ShowFullLog }}"> {{ AdminAction::ShowFullLog.long_display() }}</button></li>
        <li><button name="action" value="{{ AdminAction::ShowOneLog }}">{{ AdminAction::ShowOneLog.long_display() }}</button></li>
      </ul>

      <h2 class="section_heading">Factors</h2>
      <ul>
        <li><button name="action" value="{{ AdminAction::InsertFactors }}">{{ AdminAction::InsertFactors.long_display() }}</button></li>
        <li><button name="action" value="{{ AdminAction::UpdateFactors }}">{{ AdminAction::UpdateFactors.long_display() }}</button></li>
      </ul>
    </form>
  </div>
</div>

<div id="right">
  <h2 class="center">{{ admin_action.long_display() }}</h2>

  {% match message %}
    {% when Some with (v) %} {{ v }}
    {% when _ %} 
  {% endmatch %}

  {# Display right pane based on action taken. #}
  {% match admin_action %}
    {% when AdminAction::Start %} 

    {% when AdminAction::ShowFullLog %} 
      {% match log_records %}
        {% when Some(log_records) %} 
          {% include "log_records_table.html" %}
        {% when None %}        
      {% endmatch %}

    {% when AdminAction::ShowOneLog %}
      {% match log_records %}
        {% when Some(log_records) %} 
          {% if log_records.is_empty() %}
            No import records found.<br>
            {% include "recordnum_form.html" %}
          {% else %}
            {% include "log_records_table.html" %}
          {% endif %}
        {% when None %}
          {% include "recordnum_form.html" %}
      {% endmatch %}

    {% when _ %} not handled yet

  {% endmatch %}
 
</div>

{% endblock %}
